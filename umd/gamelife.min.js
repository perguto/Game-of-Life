!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("GameLife",[],e):"object"==typeof exports?exports.GameLife=e():t.GameLife=e()}(self,(()=>(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{default:()=>b});var n,o=function(){function t(){this.board=new Map}return t.prototype.setCell=function(t,e,n){void 0===n&&(n=!0),n?this.board.set("".concat(t,":").concat(e),{x:t,y:e}):this.board.delete("".concat(t,":").concat(e))},t.prototype.getCell=function(t,e){return this.board.has("".concat(t,":").concat(e))},t.prototype.getCells=function(){return Array.from(this.board.values())},t.prototype.resetCells=function(){this.board.clear()},t}(),i=function(){function t(){}return t.prototype.nextGeneration=function(t){for(var e=new o,n=0,i=t.getCells();n<i.length;n++){var r=i[n],s=r.x,a=r.y;this.getCellLife(t,s,a)&&e.setCell(s,a),this.getCellLife(t,s+1,a)&&e.setCell(s+1,a),this.getCellLife(t,s+1,a+1)&&e.setCell(s+1,a+1),this.getCellLife(t,s+1,a-1)&&e.setCell(s+1,a-1),this.getCellLife(t,s-1,a+1)&&e.setCell(s-1,a+1),this.getCellLife(t,s-1,a-1)&&e.setCell(s-1,a-1),this.getCellLife(t,s-1,a)&&e.setCell(s-1,a),this.getCellLife(t,s,a+1)&&e.setCell(s,a+1),this.getCellLife(t,s,a-1)&&e.setCell(s,a-1)}return e},t.prototype.getCellLife=function(t,e,n){var o=0;if(o+=t.getCell(e,n+1)?1:0,o+=t.getCell(e+1,n+1)?1:0,o+=t.getCell(e+1,n)?1:0,o+=t.getCell(e+1,n-1)?1:0,o+=t.getCell(e,n-1)?1:0,o+=t.getCell(e-1,n-1)?1:0,o+=t.getCell(e-1,n)?1:0,o+=t.getCell(e-1,n+1)?1:0,t.getCell(e,n)){if(o>=2&&o<=3)return!0}else if(3===o)return!0;return!1},t}(),r=function(){function t(t){this.evolution={isEvolving:!1,intervalID:-1,config:{onNextGeneration:function(t){},delay:500}},this.gameBoard=new o,this.engine=new i,this.graphics=t,this.initEvents()}return t.prototype.bornCell=function(t){var e=t.x,n=t.y;this.stopEvolution(),this.gameBoard.setCell(e,n,!0),this.updateGraphics()},t.prototype.bornCells=function(t){var e=this;this.stopEvolution(),t.forEach((function(t){return e.gameBoard.setCell(t.x,t.y,!0)})),this.updateGraphics()},t.prototype.killCell=function(t){var e=t.x,n=t.y;this.stopEvolution(),this.gameBoard.setCell(e,n,!1),this.updateGraphics()},t.prototype.toggleCell=function(t){var e=t.x,n=t.y;this.stopEvolution(),this.gameBoard.setCell(e,n,!this.gameBoard.getCell(e,n)),this.updateGraphics()},t.prototype.exterminateCells=function(){this.stopEvolution(),this.gameBoard.resetCells(),this.updateGraphics()},t.prototype.getCells=function(){return this.gameBoard.getCells()},t.prototype.speedUp=function(t){var e=this.evolution.config.delay;this.changeDelay(Math.floor(e/(t||1)))},t.prototype.speedDown=function(t){var e=this.evolution.config.delay;this.changeDelay(Math.floor(e/(t||1)))},t.prototype.changeDelay=function(t){this.setConfig({delay:t>=20?t:20})},t.prototype.setConfig=function(t){var e=t.onNextGeneration,n=t.delay,o=this.evolution.config;this.stopEvolution(),o.onNextGeneration=e||o.onNextGeneration,o.delay=n||o.delay,this.startEvolution()},t.prototype.startEvolution=function(){var t=this,e=this.evolution,n=e.isEvolving,o=e.config,i=o.onNextGeneration,r=o.delay;if(!n){i(this.gameBoard.getCells()),this.updateGraphics();var s=window.setInterval((function(){t.evolveGeneration(),i(t.gameBoard.getCells())}),r);this.evolution.isEvolving=!0,this.evolution.intervalID=s}},t.prototype.stopEvolution=function(){var t=this.evolution,e=t.isEvolving,n=t.intervalID;e&&-1!==n&&(clearInterval(n),this.evolution.intervalID=-1,this.evolution.isEvolving=!1)},t.prototype.evolveGeneration=function(){var t=this.engine.nextGeneration(this.gameBoard);this.gameBoard=t,this.updateGraphics()},t.prototype.updateGraphics=function(){this.graphics.setCells(this.gameBoard.getCells())},t.prototype.initEvents=function(){var t=this,e=this.graphics.events;e.on({type:"onCellBorn",callback:function(e){t.bornCell(e)}}),e.on({type:"onCellKill",callback:function(e){t.killCell(e)}}),e.on({type:"onCellToggle",callback:function(e){t.toggleCell(e)}}),e.on({type:"onGameStartStop",callback:function(){t.evolution.isEvolving?t.stopEvolution():t.startEvolution()}}),e.on({type:"onSpeedUp",callback:function(e){t.speedUp(e)}}),e.on({type:"onSpeedDown",callback:function(e){t.speedDown(e)}})},t}(),s=function(){function t(){this.listeners={onCellBorn:[],onCellKill:[],onCellToggle:[],onGameStartStop:[],onSpeedDown:[],onSpeedUp:[]}}return t.prototype.on=function(t){this.listeners[t.type].push(t.callback)},t.prototype.emit=function(t,e){this.listeners[t].forEach((function(t){return t(e)}))},t.prototype.emitCellBorn=function(t){this.emit("onCellBorn",t)},t.prototype.emitCellKill=function(t){this.emit("onCellKill",t)},t.prototype.emitCellToggle=function(t){this.emit("onCellToggle",t)},t.prototype.emitGameStartStop=function(){this.emit("onGameStartStop",null)},t.prototype.emitSpeedUp=function(t){this.emit("onSpeedUp",t)},t.prototype.emitSpeedDown=function(t){this.emit("onSpeedDown",t)},t}(),a=function(){function t(){this.events=new s,this.aliveCells=[]}return t.prototype.setCells=function(t){this.aliveCells=t,this.render()},t.prototype.render=function(){console.log("render")},t}(),l=function(){function t(t,e){this.canvas=t,this.canvasContext=e}return t.prototype.paint=function(t,e,n){this.applyTransforms(t),this.renderCells(t,e,n),this.renderGrid(t)},t.prototype.renderGrid=function(t){var e=this.canvasContext,n=t.board,o=t.grid,i=t.colors,r=t.cells,s=n.width,a=n.height,l=n.offset_x,c=n.offset_y,f=n.zoom,u=i.grid,p=r.size,h=o.lineWidth,d=o.gap;p=p*f/100,p=Math.ceil(p),e.lineWidth=h,e.strokeStyle=u;for(var g=p+4*d,v=0;v<2*s+Math.abs(l);v+=g)e.moveTo(v,d-a-c),e.lineTo(v,2*a-c),e.moveTo(2*d-v,d-a-c),e.lineTo(2*d-v,2*a-c);for(var y=0;y<2*a+Math.abs(c);y+=g)e.moveTo(d-s-l,y),e.lineTo(2*s-l,y),e.moveTo(d-s-l,2*d-y),e.lineTo(2*s-l,2*d-y);e.stroke()},t.prototype.renderCells=function(t,e,n){var o=this.canvasContext,i=t.cells,r=t.colors,s=t.grid,a=t.board.zoom,l=r.cell,c=r.selected_cell,f=s.gap,u=i.size;u=u*a/100;var p=(u=Math.ceil(u))+4*f;o.fillStyle=l;for(var h=0,d=e;h<d.length;h++){var g=(m=d[h]).x*p+2*f,v=m.y*p+2*f;o.fillRect(g,v,u,u)}o.fillStyle=c;for(var y=0,C=n;y<C.length;y++){var m;g=(m=C[y]).x*(u+4*f)+3*f,v=m.y*(u+4*f)+3*f,o.fillRect(g,v,u,u)}},t.prototype.renderBackground=function(t){var e=this.canvasContext,n=t.board,o=t.colors,i=n.width,r=n.height,s=n.offset_x,a=n.offset_y,l=o.background;e.fillStyle=l,e.fillRect(0-s,0-a,i,r)},t.prototype.applyTransforms=function(t){var e=this.canvasContext,n=t.board,o=n.offset_x,i=n.offset_y,r=n.zoom/100,s=e.getTransform(),a=s.a!==r,l=s.e!==o||s.f!==i;(a||l)&&(e.reset(),e.translate(o,i)),e.translate(.5,.5)},t}(),c={cells:{size:20},grid:{lineWidth:1,gap:.5},board:{height:900,width:1900,offset_x:0,offset_y:0,zoom:100},colors:{background:"#222222",cell:"#ffffff",selected_cell:"rgba(255,255,255,0.2)",grid:"#626567"}},f=function(t,e,n){this.canvas=t,this.getConfig=e,this.setConfig=n},u=(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),p=function(t){function e(e,n,o,i,r){var s=t.call(this,e,n,o)||this;return s.getSelectedCells=i,s.setSelectCells=r,s.listeners={onCellClicked:[]},s.init(),s}return u(e,t),e.prototype.onCellClicked=function(t){this.listeners.onCellClicked.push(t)},e.prototype.emitCellSelected=function(t){this.listeners.onCellClicked.forEach((function(e){return e(t)}))},e.prototype.init=function(){var t=this,e=this.canvas;e.addEventListener("mousemove",(function(e){var n=e.offsetX,o=e.offsetY,i=t.getConfig(),r=i.board,s=i.cells,a=i.grid,l=(r.width,r.height,r.offset_x),c=r.offset_y,f=r.zoom,u=(a.lineWidth,a.gap),p=s.size;p=p*f/100;var h=(p=Math.ceil(p))+4*u,d=Math.floor((n-l)/h),g=Math.floor((o-c)/h);t.setSelectCells([{x:d,y:g}])})),e.addEventListener("dblclick",(function(e){var n=t.getSelectedCells()[0];n&&t.emitCellSelected(n)}))},e}(f),h=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),d=function(){return d=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},d.apply(this,arguments)},g=function(t){function e(e,n,o){var i=t.call(this,e,n,o)||this;return i.state={isDragging:!1,lastX:0,lastY:0},i.init(),i}return h(e,t),e.prototype.init=function(){var t=this,e=this.canvas;e.onmousedown=function(e){var n=t.state;n.isDragging||(t.state=d(d({},n),{isDragging:!0,lastX:e.x,lastY:e.y}))},e.onmouseup=function(e){var n=t.state;n.isDragging&&(t.state=d(d({},n),{isDragging:!1,lastX:0,lastY:0}))},e.onmousemove=function(e){var n=t.state;if(n.isDragging){var o=n.lastX,i=n.lastY,r=t.getConfig().board,s=r.offset_x,a=r.offset_y,l=(r.zoom,s+(e.x-o)),c=a+(e.y-i);t.setConfig({board:{offset_x:l,offset_y:c}}),t.state=d(d({},n),{lastX:e.x,lastY:e.y})}},e.onwheel=function(e){e.preventDefault();var n=Math.sign(e.deltaY),o=t.getConfig().board,i=o.zoom-n*o.zoom/20;i=Math.min(i,200),i=Math.max(i,50),i=Math.round(i),t.setConfig({board:{zoom:i}})}},e}(f),v=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),y=function(t){function e(e,n,o){var i=t.call(this,e,n,o)||this;return i.listeners={onGameStartStop:[],onSpeedDown:[],onSpeedUp:[]},i.init(),i}return v(e,t),e.prototype.onGameStartStop=function(t){this.listeners.onGameStartStop.push(t)},e.prototype.onSpeedUp=function(t){this.listeners.onSpeedUp.push(t)},e.prototype.onSpeedDowm=function(t){this.listeners.onSpeedDown.push(t)},e.prototype.emitGameStartStop=function(){this.listeners.onGameStartStop.forEach((function(t){return t()}))},e.prototype.emitSpeedUp=function(t){this.listeners.onSpeedUp.forEach((function(e){return e(t)}))},e.prototype.emitSpeedDown=function(t){this.listeners.onSpeedDown.forEach((function(e){return e(t)}))},e.prototype.init=function(){var t=this;window?window.addEventListener("keydown",(function(e){return t.onKey(e)})):this.canvas.ownerDocument.addEventListener("keydown",(function(e){return t.onKey(e)}))},e.prototype.onKey=function(t){switch(t.key){case"Enter":this.emitGameStartStop();break;case"+":this.emitSpeedUp(1.2);break;case"-":this.emitSpeedDown(.8)}},e}(f),C=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=function(){return m=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},m.apply(this,arguments)},w=function(t){function e(e){var n=t.call(this)||this;if(n.selectedCells=[],n.canvas=e,n.canvasContext=e.getContext("2d")||new CanvasRenderingContext2D,!n.canvas||!n.canvas.getContext("2d"))throw new Error("Canvas cannot be null");return n.config=c,n.listeners={onConfigChange:[]},n.painter=new l(e,n.canvasContext),n.plugins=[],n.initPlugins(),n.configDOMCanvas(),n}return C(e,t),e.prototype.render=function(){this.painter.paint(this.config,this.aliveCells,this.selectedCells)},e.prototype.initPlugins=function(){var t=this,e=new g(this.canvas,(function(){return t.getConfig()}),(function(e){return t.setConfig(e)})),n=new p(this.canvas,(function(){return t.getConfig()}),(function(e){return t.setConfig(e)}),(function(){return t.selectedCells}),(function(e){return t.setSelectedCells(e)}));n.onCellClicked((function(e){t.events.emitCellToggle(e)}));var o=new y(this.canvas,(function(){return t.getConfig()}),(function(e){return t.setConfig(e)}));o.onGameStartStop((function(){t.events.emitGameStartStop()})),o.onSpeedUp((function(e){t.events.emitSpeedUp(e)})),o.onSpeedDowm((function(e){t.events.emitSpeedDown(e)})),this.plugins=[e,n,o]},e.prototype.configDOMCanvas=function(){var t=this.config.board,e=t.height,n=t.width,o=this.canvas,i=o.width,r=o.height;this.canvas.style.width="".concat(this.config.board.width,"px"),this.canvas.style.height="".concat(this.config.board.height,"px"),n!==i&&(this.canvas.width=this.config.board.width),e!==r&&(this.canvas.height=this.config.board.height),this.canvas.style.overflow="hidden",this.canvas.style.backgroundColor=this.config.colors.background},e.prototype.setSelectedCells=function(t){this.selectedCells=t,this.render()},e.prototype.getConfig=function(){var t=this.config,e=t.board,n=t.cells,o=t.colors,i=t.grid;return{board:m({},e),cells:m({},n),colors:m({},o),grid:m({},i)}},e.prototype.setConfig=function(t){var e=this,n=t.board,o=t.cells,i=t.colors,r=t.grid;this.config={board:m(m({},this.config.board),n),cells:m(m({},this.config.cells),o),colors:m(m({},this.config.colors),i),grid:m(m({},this.config.grid),r)},window.requestAnimationFrame((function(){e.render(),e.configDOMCanvas(),setTimeout((function(){e.listeners.onConfigChange.forEach((function(t){return t(e.getConfig())}))}),1)}))},e.prototype.onConfigChange=function(t){this.listeners.onConfigChange.push(t)},e}(a);!function(){function t(t){this.defaultValue=t,this.quadrant1=[[]],this.quadrant2=[[]],this.quadrant3=[[]],this.quadrant4=[[]]}t.prototype.setPoint=function(t,e){var n=t.x,o=t.y;n>=0&&o>=0?(this.verifyRow(n,this.quadrant1),this.quadrant1[n][o]=e):n<0&&o>=0?(this.verifyRow(-1*n,this.quadrant2),this.quadrant2[-1*n][o]=e):n<0&&o<0?(this.verifyRow(-1*n,this.quadrant3),this.quadrant3[-1*n][-1*o]=e):(this.verifyRow(n,this.quadrant4),this.quadrant4[n][-1*o]=e)},t.prototype.getPoint=function(t){var e=t.x,n=t.y;return e>=0&&n>=0?this.quadrant1[e]&&this.quadrant1[e][n]||this.defaultValue:e<0&&n>=0?this.quadrant2[-1*e]&&this.quadrant2[-1*e][n]||this.defaultValue:e<0&&n<0?this.quadrant3[-1*e]&&this.quadrant3[-1*e][-1*n]||this.defaultValue:this.quadrant4[e]&&this.quadrant4[e][-1*n]||this.defaultValue},t.prototype.resetPlane=function(){this.quadrant1=[],this.quadrant2=[],this.quadrant3=[],this.quadrant4=[]},t.prototype.verifyRow=function(t,e){e[t]||(e[t]=[])}}();const b=function(t,e){void 0===e&&(e={});var n=new w(t),o=new r(n),i=e.game,s=e.graphics;return i&&o.setConfig(i),s&&n.setConfig(s),o};return e.default})()));